<template>
  <div>
    <div class="goods" v-for="(item, index) in cartarr" :key="index">
      <img :src="item.pic" alt="">
      <span class="title">{{item.title}}</span>
      <div class="goodsright">
        <!-- cube-uiçš„â€œç§»é™¤å›¾æ ‡â€ -->
        <i class="cubeic-remove" @click="removeCart(index)"></i>
        <span>{{item.cartCount}}</span>
        <!-- cube-uiçš„â€œæ·»åŠ å›¾æ ‡â€ -->
        <i class="cubeic-add" @click="addCart(index)"></i>
      </div>
    </div>
    <!-- cube-button: CubeUIå°è£…å¥½çš„buttonæŒ‰é’®ç»„ä»¶ -->
    <cube-button style="margin:10px 0;">ä¸‹å•</cube-button>
    <cube-button @click="clearcart">æ¸…ç©ºè´­ç‰©è½¦</cube-button>
  </div>
</template>

<script>
import {mapState} from 'vuex'
  export default {
    data() {
      return {
        // cartarr:[]  //ç”±äºå·²ç»å°†ä»vuexä¸­è·å–åˆ°çš„cartarryèµ‹å€¼ç»™cartarräº†ï¼Œæ‰€ä»¥data()ä¸­å·²ç»ä¸éœ€è¦å†é…ç½®cartarräº†
      }
    },
    computed: {
      //ğŸ“Œå°†æ•°æ®ä»vuexä¸­å–å‡ºæ¥ä½¿ç”¨
      ...mapState({       //ğŸ“Œä¸ºä½•è¦å±•å¼€ï¼Œå› ä¸ºmapStateçš„è¿”å›ç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡{key:value}çš„å½¢å¼ï¼Œæ‰€ä»¥è¦â€œå±•å¼€å–å‡ºâ€é‡Œé¢çš„key:valueæ”¾å…¥computed:{}ä¸­                                                              //        computed:{             
        cartarr:state => state.cartarry  //ğŸ“Œè®¡ç®—å±æ€§çš„â€œcartarr()æ–¹æ³•çš„returnè¿”å›å€¼â€å†åŒ…ä¸€å±‚â€œç®­å¤´å‡½æ•°çš„returnè¿”å›å€¼â€ï¼Œå³return (return state.cartarry) ï¼Œå³æ‹¿åˆ°stateæ•°æ®ä»“ä¸­çš„cartarry[]ç„¶å...å±•å¼€è‡³computed:{}ä¸­  =>   cartarr:cartarry   
      })                                                                                                                                                                                      //        }                
    },
    methods: {
      //å‡å°‘å•†å“
      removeCart(index){
        // this.cartarr[index].cartCount -= 1  //ç‚¹å‡»æŒ‰é’®æ•°é‡-1  -(ç›´æ¥åœ¨ç»„ä»¶ä¸­é…ç½®å®ç°)
        //ğŸ“Œé€šè¿‡è°ƒç”¨commitç›´æ¥ä¸mutationsè¿›è¡Œå¯¹è¯ï¼Œä»è€Œå®ç°åœ¨mutationsä¸­æ“ä½œstate.cartarryæ¥å®ç°è´­ç‰©è½¦å•†å“æ•°é‡çš„â€œå‡1æ“ä½œâ€  -(åˆ©ç”¨vuexå®ç°)
        this.$store.commit('cartremove',index)
      },
      //å¢åŠ å•†å“
      addCart(index){
        // this.cartarr[index].cartCount += 1  //ç‚¹å‡»æŒ‰é’®æ•°é‡+1  (ç›´æ¥åœ¨ç»„ä»¶ä¸­é…ç½®å®ç°) 
        //ğŸ“Œé€šè¿‡è°ƒç”¨commitç›´æ¥ä¸mutationsè¿›è¡Œå¯¹è¯ï¼Œä»è€Œå®ç°åœ¨mutationsä¸­æ“ä½œstate.cartarryæ¥å®ç°è´­ç‰©è½¦å•†å“æ•°é‡çš„â€œåŠ 1æ“ä½œâ€  -(åˆ©ç”¨vuexå®ç°)
        this.$store.commit('cartadd',index)
      },
      //æ¸…ç©ºè´­ç‰©è½¦
      clearcart(){
        //ğŸ“Œé€šè¿‡è°ƒç”¨commitç›´æ¥ä¸mutationsè¿›è¡Œå¯¹è¯ï¼Œä»è€Œå®ç°â€œæ¸…ç©ºè´­ç‰©è½¦â€åŠŸèƒ½
        this.$store.commit('clearcart')
      }
    },
  }
</script>

<style lang="stylus" scoped>
  .goods
    padding 10px
    text-align left
    img
      width 80px
      vertical-align middle
    .title
      vertical-align middle
      margin-left 48%
      font-size 21px
    .goodsright
      float right
      margin-top 25px
      i
        font-size 18px
</style>